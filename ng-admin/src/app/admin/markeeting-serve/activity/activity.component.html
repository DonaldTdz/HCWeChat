<!--component html goes here -->
<!-- <div class="content__title">
    <h1>UEditor
        <small>Dependencies
            <a href="//github.com/cipchk/ngx-ueditor" target="_blank">ngx-ueditor</a>
        </small>
    </h1>
</div> -->

<!-- <nz-card>
    <ueditor [(ngModel)]="html"></ueditor>
</nz-card> -->

<form nz-form [formGroup]="formA" id="frm_create_role" (ngSubmit)="saveSub()">
    <nz-card [nzBordered]="false">
        <div nz-row [nzGutter]="16">
            <div nz-col nzMd="7" nzSm="12" nzXs="24">
                <div nz-form-item nz-row>
                    <div nz-form-label nz-col>
                        <label nz-form-item-required>活动名称</label>
                    </div>
                    <div nz-form-control nz-col nzHasFeedback [nzValidateStatus]="getFormControl('name')">
                        <nz-input formControlName="name" [(ngModel)]="acitivityDto.name" [nzId]="'name'"></nz-input>
                        <div nz-form-explain *ngIf="getFormControl('name').dirty&&getFormControl('name').hasError('maxlength')">字符长度小于等于200</div>
                        <div nz-form-explain *ngIf="getFormControl('name').dirty&&getFormControl('name').hasError('required')">请输入活动名称</div>
                    </div>
                </div>
            </div>
            <div nz-col nzMd="7" nzSm="12" nzXs="24">
                <div nz-form-item nz-row>
                    <div nz-form-label nz-col>
                        <label>活动状态</label>
                    </div>
                    <div nz-form-control nz-col class="text-pink-light h3">
                        {{acitivityDto.statusName}}
                    </div>
                </div>
            </div>
            <div nz-col nzMd="6" nzSm="12" nzXs="24">
                <div nz-form-item nz-row>
                    <div nz-form-label nz-col>
                        <label>活动发布时间</label>
                    </div>
                    <div nz-form-control nz-col class="text-pink-light h3">
                        {{publishTimes}}
                    </div>
                </div>
            </div>
        </div>
        <!-- <div nz-col nzMd="6" nzSm="12" nzXs="24">
            <div nz-form-item nz-row>
                <div nz-form-label nz-col>
                    <label></label>
                </div>
            </div>
        </div> -->



        <div nz-row [nzGutter]="16">

            <div nz-col nzMd="7" nzSm="12" nzXs="24">
                <div nz-form-item nz-row>
                    <div nz-form-label nz-col>
                        <label nz-form-item-required>活动开始时间</label>
                    </div>
                    <div nz-form-control nz-col nzHasFeedback [nzValidateStatus]="getFormControl('beginTime')">
                        <nz-datepicker [nzSize]="large" formControlName="beginTime" [(ngModel)]="acitivityDto.beginTime"></nz-datepicker>
                        <div nz-form-explain *ngIf="getFormControl('beginTime').dirty&&getFormControl('beginTime').hasError('required')">请输入活动开始时间</div>
                    </div>
                </div>
            </div>

            <div nz-col nzMd="7" nzSm="12" nzXs="24">
                <div nz-form-item nz-row>
                    <div nz-form-label nz-col>
                        <label nz-form-item-required>活动结束时间</label>
                    </div>
                    <div nz-form-control nz-col nzHasFeedback [nzValidateStatus]="getFormControl('endTime')">
                        <nz-datepicker [nzSize]="{width:'80px;'}" formControlName="endTime" [(ngModel)]="acitivityDto.endTime" nzPlaceHolder="请输入小于等于32的字符"></nz-datepicker>
                        <div nz-form-explain *ngIf="getFormControl('endTime').dirty&&getFormControl('endTime').hasError('required')">请输入活动结束时间</div>
                    </div>

                </div>
            </div>

            <div nz-col nzMd="6" nzSm="12" nzXs="24">
                <div nz-form-item nz-row>
                    <div nz-form-label nz-col>
                        <label nz-form-item-required>活动分类</label>
                    </div>
                    <div nz-form-control nz-col nzHasFeedback [nzValidateStatus]="getFormControl('activityType')">
                        <nz-select formControlName="activityType" [nzPlaceHolder]="'活动分类'" [nzShowSearch]="true" nzSize="large">
                            <nz-option *ngFor="let i of AcTypes" [nzLabel]="i.text" [nzValue]="i.value">
                            </nz-option>
                        </nz-select>
                    </div>
                </div>
            </div>

        </div>

        <div nz-row [nzGutter]="16">

            <div nz-col nzMd="7" nzSm="12" nzXs="24">
                <div nz-form-item nz-row>
                    <div nz-form-label nz-col>
                    </div>
                    <div nz-form-control nz-col nzHasFeedback>
                        <label>未完用烟申请限制</label>
                    </div>
                </div>
            </div>

            <div nz-col nzMd="7" nzSm="12" nzXs="24">
                <div nz-form-item nz-row>
                    <div nz-form-label nz-col>
                        <label>客户经理</label>
                    </div>
                    <div nz-form-control nz-col nzHasFeedback [nzValidateStatus]="getFormControl('mUnfinished')">
                        <nz-input-number [nzSize]="large" [nzStep]="1" [nzMin]="0" [nzMax]="9999" formControlName="mUnfinished" [(ngModel)]="acitivityDto.mUnfinished"></nz-input-number>
                    </div>
                </div>
            </div>

            <div nz-col nzMd="6" nzSm="12" nzXs="24">
                <div nz-form-item nz-row>
                    <div nz-form-label nz-col>
                        <label>零售客户</label>
                    </div>
                    <div nz-form-control nz-col nzHasFeedback [nzValidateStatus]="getFormControl('rUnfinished')">
                        <nz-input-number [nzSize]="large" [nzStep]="1" [nzMin]="0" [nzMax]="9999" formControlName="rUnfinished" [(ngModel)]="acitivityDto.rUnfinished"></nz-input-number>
                    </div>
                </div>
            </div>
        </div>

        <div nz-row [nzGutter]="16">
            <div nz-form-label nz-col>
                <label nz-form-item-required>活动内容</label>
            </div>
            <div nz-form-control nz-col nzHasFeedback [nzValidateStatus]="getFormControl('content')">
                <nz-input formControlName="content" [(ngModel)]="acitivityDto.content" [nzId]="'content'"></nz-input>
                <div nz-form-explain *ngIf="getFormControl('content').dirty&&getFormControl('content').hasError('required')">请输入活动内容</div>
            </div>

        </div>

    </nz-card>
    <nz-card *ngIf="true" [nzBordered]="false">
        <!-- <form nz-form [nzLayout]="'inline'">
            <div nz-row [nzGutter]="24">
                <ng-template #deleteContent>
                    <h2>是否删除商品{{employeeName}}?</h2>
                </ng-template>
                <div nz-col [nzSpan]="8" class="mb-md">
                    <div nz-form-item class="d-flex">
                        <div nz-form-control class="flex-1">
                            <nz-input [(ngModel)]="searchName" name="searchName" [nzSize]="'large'" [nzPlaceHolder]="'请输入商品名'" nzId="searchName"></nz-input>
                        </div>
                    </div>
                </div>
                <div nz-col [nzSpan]="8" class="mb-md" [class.text-right]="'true'">
                    <button nz-button (click)="refreshData()" [nzType]="'primary'" [nzLoading]="loading" [nzSize]="'large'">查询</button>
                    <button nz-button (click)="createGoods()" [nzType]="'primary'" [nzSize]="'large'">
                        <i class="anticon anticon-plus"></i>
                        <span>新建</span>
                    </button>
                </div>
            </div>
        </form>
        <nz-table #nzTable [nzAjaxData]="goodes" [nzTotal]="query.total" [(nzPageIndex)]="query.pageIndex" [(nzPageSize)]="query.pageSize" [nzLoading]="loading"
            [nzShowSizeChanger]="true" (nzPageIndexChange)="refreshData()" (nzPageSizeChange)="refreshData()">
            <thead nz-thead>
                <tr>
                    <th nz-th>
                        <span>商品规格</span>
                    </th>
                    <th nz-th>
                        <span>单次申请最小限制</span>
                    </th>
                    <th nz-th>
                        <span>单次申请最大限制</span>
                    </th>
                    <th nz-th>
                        <span>优惠说明</span>
                    </th>
                    <th nz-th>
                        <span>操作</span>
                    </th>
                </tr>
            </thead>
            <tbody nz-tbody>
                <tr nz-tbody-tr *ngFor="let goods of nzTable.data let i=index" [formGroupName]="i">
                    <td nz-td>
                        {{goods.specification}}
                    </td>
                    <td nz-td>{{goods.minNum}}</td>
                    <td nz-td>{{goods.maxNum}}</td>
                    <td nz-td>{{goods.discountDesc}}</td>
                    <td nz-td>
                        <a (click)="editGoods(goods)">编辑</a>
                        <span nz-table-divider></span>
                        <a (click)="delete(goods,deleteContent)">删除</a>
                    </td>
                </tr>
            </tbody>
        </nz-table> -->
        <!-- <ng-template #modelContent>
            <h2>请先添加商品！</h2>
        </ng-template> -->
        <nz-table formArrayName="items" [nzDataSource]="items.value" [nzIsPagination]="false">
            <thead nz-thead>
                <tr>
                    <th nz-th>商品规格</th>
                    <th nz-th>单次申请最小限制</th>
                    <th nz-th>单次申请最大限制</th>
                    <th nz-th>优惠说明</th>
                    <th nz-th>操作</th>
                </tr>
            </thead>
            <tbody nz-tbody>
                <tr nz-tbody-tr *ngFor="let item of items.controls; let i = index" [formGroupName]="i">
                    <td nz-td>
                        <span *ngIf="editIndex!==i">{{items.value[i].specification}}</span>
                        <span *ngIf="editIndex===i" nz-form-control [nzValidateStatus]="item.controls.specification">
                            <nz-input formControlName="specification" [(ngModel)]="good.specification" nzPlaceHolder="商品规格" nzSize="large"></nz-input>
                        </span>
                    </td>
                    <td nz-td>
                        <span *ngIf="editIndex!==i">{{items.value[i].minNum}}</span>
                        <span *ngIf="editIndex===i" nz-form-control [nzValidateStatus]="item.controls.minNum">
                            <nz-input formControlName="minNum" [(ngModel)]="good.minNum" nzPlaceHolder="单次申请最小限制" nzSize="large"></nz-input>
                        </span>
                    </td>
                    <td nz-td>
                        <span *ngIf="editIndex!==i">{{items.value[i].maxNum}}</span>
                        <span *ngIf="editIndex===i" nz-form-control [nzValidateStatus]="item.controls.maxNum">
                            <nz-input formControlName="maxNum" [(ngModel)]="good.maxNum" nzPlaceHolder="单次申请最大限制" nzSize="large"></nz-input>
                        </span>
                    </td>
                    <td nz-td>
                        <span *ngIf="editIndex!==i">{{items.value[i].discountDesc}}</span>
                        <span *ngIf="editIndex===i" nz-form-control [nzValidateStatus]="item.controls.discountDesc">
                            <nz-input formControlName="discountDesc" [(ngModel)]="good.discountDesc" nzPlaceHolder="优惠说明" nzSize="large"></nz-input>
                        </span>
                    </td>
                    <td nz-td style="display:none">
                        <span *ngIf="editIndex!==i">{{items.value[i].id}}</span>
                        <span *ngIf="editIndex===i" nz-form-control [nzValidateStatus]="item.controls.id">
                            <nz-input formControlName="id" [(ngModel)]="good.id" nzPlaceHolder="商品id" nzSize="large"></nz-input>
                        </span>
                    </td>
                    <td nz-td>
                        <span *ngIf="editIndex!==i">
                            <a (click)="edit(i)">编辑</a>
                            <span nz-table-divider></span>
                            <nz-popconfirm (nzOnConfirm)="delete(i,items.value[i].id)" [nzTitle]="'是否要删除'+items.value[i].specification+'?'">
                                <a nz-popconfirm>删除</a>
                            </nz-popconfirm>
                        </span>
                        <span *ngIf="editIndex===i">
                            <a (click)="save(i)">保存</a>
                            <span nz-table-divider></span>
                            <nz-popconfirm (nzOnConfirm)="cancel(i)" [nzTitle]="'是否要取消操作？'">
                                <a nz-popconfirm>取消</a>
                            </nz-popconfirm>
                        </span>
                    </td>
                </tr>
            </tbody>
        </nz-table>
        <button *ngIf="editIndex===-1" nz-button [nzType]="'dashed'" [nzSize]="'large'" (click)="add()" class="ant-btn__block mt-md">
            <i class="anticon anticon-plus"></i>
            <span>新增成员</span>
        </button>
    </nz-card>

    <button *ngIf="isSave" nz-button [nzType]="'primary'" [nzSize]="'large'" type="submit" [nzLoading]="isConfirmLoading">
        {{l("保存")}}
    </button>
    <button *ngIf="isPulish" nz-button [nzType]="'primary'" (click)="pulish(modelContent)" [nzSize]="'large'" [nzLoading]="isConfirmLoading">
        {{l("发布")}}
    </button>

</form>


<!-- <footer-boolbar errorCollect>
    <button nz-button [nzType]="'primary'" [nzSize]="'large'" type="submit" [nzLoading]="isConfirmLoading">
        {{l("保存")}}
    </button>
    <button nz-button [nzType]="'primary'" [nzSize]="'large'"  [nzLoading]="isConfirmLoading">
        {{l("发布")}}
    </button>
</footer-boolbar> -->