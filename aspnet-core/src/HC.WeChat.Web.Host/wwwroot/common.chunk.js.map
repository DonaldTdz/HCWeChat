{"version":3,"sources":["D:/projects/hc/HCWeChat/ng-admin/src/app/shared/auth/auth-route-guard.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAA2C;AACqC;AACb;AAO1C;AAGzB;IAEI,uBACY,kBAA4C,EAC5C,OAAe,EACf,eAAkC;QAFlC,uBAAkB,GAAlB,kBAAkB,CAA0B;QAC5C,YAAO,GAAP,OAAO,CAAQ;QACf,oBAAe,GAAf,eAAe,CAAmB;IAC1C,CAAC;IAEL,mCAAW,GAAX,UAAY,KAA6B,EAAE,KAA0B;QACjE,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC,CAAC;YAC7B,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,eAAe,CAAC,CAAC,CAAC;YACzC,MAAM,CAAC,KAAK,CAAC;QACjB,CAAC;QAED,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;YAC3C,MAAM,CAAC,IAAI,CAAC;QAChB,CAAC;QAED,EAAE,CAAC,CAAC,IAAI,CAAC,kBAAkB,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,CAAC;YAC9D,MAAM,CAAC,IAAI,CAAC;QAChB,CAAC;QAED,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,eAAe,EAAE,CAAC,CAAC,CAAC;QAChD,MAAM,CAAC,KAAK,CAAC;IACjB,CAAC;IAED,wCAAgB,GAAhB,UAAiB,KAA6B,EAAE,KAA0B;QACtE,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;IAC1C,CAAC;IAED,uCAAe,GAAf;QACI,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC,CAAC;YAC7B,MAAM,CAAC,eAAe,CAAC;QAC3B,CAAC;QAED,EAAE,CAAC,CAAC,IAAI,CAAC,kBAAkB,CAAC,SAAS,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC;YACnD,MAAM,CAAC,aAAa,CAAC;QACzB,CAAC;QAED,MAAM,CAAC,YAAY,CAAC;IACxB,CAAC;IAxCQ,aAAa;QADzB,iEAAU,EAAE;yCAIuB,sGAAwB;YACnC,+DAAM;YACE,uFAAiB;OALrC,aAAa,CAyCzB;IAAD,oBAAC;CAAA;AAzCyB","file":"common.chunk.js","sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { PermissionCheckerService } from \"@abp/auth/permission-checker.service\";\r\nimport { AppSessionService } from '../session/app-session.service';\r\n\r\nimport {\r\n    CanActivate, Router,\r\n    ActivatedRouteSnapshot,\r\n    RouterStateSnapshot,\r\n    CanActivateChild\r\n} from '@angular/router';\r\n\r\n@Injectable()\r\nexport class AppRouteGuard implements CanActivate, CanActivateChild {\r\n\r\n    constructor(\r\n        private _permissionChecker: PermissionCheckerService,\r\n        private _router: Router,\r\n        private _sessionService: AppSessionService,\r\n    ) { }\r\n\r\n    canActivate(route: ActivatedRouteSnapshot, state: RouterStateSnapshot): boolean {\r\n        if (!this._sessionService.user) {\r\n            this._router.navigate(['account/login']);\r\n            return false;\r\n        }\r\n\r\n        if (!route.data || !route.data[\"permission\"]) {\r\n            return true;\r\n        }\r\n\r\n        if (this._permissionChecker.isGranted(route.data[\"permission\"])) {\r\n            return true;\r\n        }\r\n\r\n        this._router.navigate([this.selectBestRoute()]);\r\n        return false;\r\n    }\r\n\r\n    canActivateChild(route: ActivatedRouteSnapshot, state: RouterStateSnapshot): boolean {\r\n        return this.canActivate(route, state);\r\n    }\r\n\r\n    selectBestRoute(): string {\r\n        if (!this._sessionService.user) {\r\n            return 'account/login';\r\n        }\r\n        \r\n        if (this._permissionChecker.isGranted('Pages.Users')) {\r\n            return 'admin/users';\r\n        }\r\n\r\n        return 'home/index';\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// D:/projects/hc/HCWeChat/ng-admin/src/app/shared/auth/auth-route-guard.ts"],"sourceRoot":"webpack:///"}